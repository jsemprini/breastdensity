#test time
system.time(replicate(10000, DID_NB2_mean(1)))


#run sim on rates
results1<- do.call(rbind, replicate(10000, DID_NB2_mean(1) , simplify=FALSE ))
results2<- do.call(rbind, replicate(10000, DID_NB2_mean(2) , simplify=FALSE ))
results3<- do.call(rbind, replicate(10000, DID_NB2_mean(3) , simplify=FALSE ))
results4<- do.call(rbind, replicate(10000, DID_NB2_mean(4) , simplify=FALSE ))
results5<- do.call(rbind, replicate(10000, DID_NB2_mean(5) , simplify=FALSE ))
results6<- do.call(rbind, replicate(10000, DID_NB2_mean(6) , simplify=FALSE ))
results7<- do.call(rbind, replicate(10000, DID_NB2_mean(7) , simplify=FALSE ))
results8<- do.call(rbind, replicate(10000, DID_NB2_mean(8) , simplify=FALSE ))
results9<- do.call(rbind, replicate(10000, DID_NB2_mean(9) , simplify=FALSE ))
results10<- do.call(rbind, replicate(10000, DID_NB2_mean(10) , simplify=FALSE ))
results11<- do.call(rbind, replicate(10000, DID_NB2_mean(11) , simplify=FALSE ))
results12<- do.call(rbind, replicate(10000, DID_NB2_mean(12) , simplify=FALSE ))
results13<- do.call(rbind, replicate(10000, DID_NB2_mean(13) , simplify=FALSE ))
results14<- do.call(rbind, replicate(10000, DID_NB2_mean(14) , simplify=FALSE ))
results15<- do.call(rbind, replicate(10000, DID_NB2_mean(15) , simplify=FALSE ))
results16<- do.call(rbind, replicate(10000, DID_NB2_mean(16) , simplify=FALSE ))
results17<- do.call(rbind, replicate(10000, DID_NB2_mean(17) , simplify=FALSE ))
results18<- do.call(rbind, replicate(10000, DID_NB2_mean(18) , simplify=FALSE ))
results19<- do.call(rbind, replicate(10000, DID_NB2_mean(19) , simplify=FALSE ))
results20<- do.call(rbind, replicate(10000, DID_NB2_mean(20) , simplify=FALSE ))
results21<- do.call(rbind, replicate(10000, DID_NB2_mean(21) , simplify=FALSE ))
results22<- do.call(rbind, replicate(10000, DID_NB2_mean(22) , simplify=FALSE ))
results23<- do.call(rbind, replicate(10000, DID_NB2_mean(23) , simplify=FALSE ))
results24<- do.call(rbind, replicate(10000, DID_NB2_mean(24) , simplify=FALSE ))
results25<- do.call(rbind, replicate(10000, DID_NB2_mean(25) , simplify=FALSE ))
results26<- do.call(rbind, replicate(10000, DID_NB2_mean(26) , simplify=FALSE ))
results27<- do.call(rbind, replicate(10000, DID_NB2_mean(27) , simplify=FALSE ))
results28<- do.call(rbind, replicate(10000, DID_NB2_mean(28) , simplify=FALSE ))
results29<- do.call(rbind, replicate(10000, DID_NB2_mean(29) , simplify=FALSE ))
results30<- do.call(rbind, replicate(10000, DID_NB2_mean(30) , simplify=FALSE ))
results31<- do.call(rbind, replicate(10000, DID_NB2_mean(31) , simplify=FALSE ))
results32<- do.call(rbind, replicate(10000, DID_NB2_mean(32) , simplify=FALSE ))
results33<- do.call(rbind, replicate(10000, DID_NB2_mean(33) , simplify=FALSE ))
results34<- do.call(rbind, replicate(10000, DID_NB2_mean(34) , simplify=FALSE ))
results35<- do.call(rbind, replicate(10000, DID_NB2_mean(35) , simplify=FALSE ))
results36<- do.call(rbind, replicate(10000, DID_NB2_mean(36) , simplify=FALSE ))
results37<- do.call(rbind, replicate(10000, DID_NB2_mean(37) , simplify=FALSE ))
results38<- do.call(rbind, replicate(10000, DID_NB2_mean(38) , simplify=FALSE ))
results39<- do.call(rbind, replicate(10000, DID_NB2_mean(39) , simplify=FALSE ))
results40<- do.call(rbind, replicate(10000, DID_NB2_mean(40) , simplify=FALSE ))
results41<- do.call(rbind, replicate(10000, DID_NB2_mean(41) , simplify=FALSE ))
results42<- do.call(rbind, replicate(10000, DID_NB2_mean(42) , simplify=FALSE ))
results43<- do.call(rbind, replicate(10000, DID_NB2_mean(43) , simplify=FALSE ))
results44<- do.call(rbind, replicate(10000, DID_NB2_mean(44) , simplify=FALSE ))
results45<- do.call(rbind, replicate(10000, DID_NB2_mean(45) , simplify=FALSE ))
results46<- do.call(rbind, replicate(10000, DID_NB2_mean(46) , simplify=FALSE ))
results47<- do.call(rbind, replicate(10000, DID_NB2_mean(47) , simplify=FALSE ))
results48<- do.call(rbind, replicate(10000, DID_NB2_mean(48) , simplify=FALSE ))




#save output
write.csv(results1, file = "results1.csv")
write.csv(results2, file = "results2.csv")
write.csv(results3, file = "results3.csv")
write.csv(results4, file = "results4.csv")
write.csv(results5, file = "results5.csv")
write.csv(results6, file = "results6.csv")
write.csv(results7, file = "results7.csv")
write.csv(results8, file = "results8.csv")
write.csv(results9, file = "results9.csv")
write.csv(results10, file = "results10.csv")
write.csv(results11, file = "results11.csv")
write.csv(results12, file = "results12.csv")
write.csv(results13, file = "results13.csv")
write.csv(results14, file = "results14.csv")
write.csv(results15, file = "results15.csv")
write.csv(results16, file = "results16.csv")
write.csv(results17, file = "results17.csv")
write.csv(results18, file = "results18.csv")
write.csv(results19, file = "results19.csv")
write.csv(results20, file = "results20.csv")
write.csv(results21, file = "results21.csv")
write.csv(results22, file = "results22.csv")
write.csv(results23, file = "results23.csv")
write.csv(results24, file = "results24.csv")
write.csv(results25, file = "results25.csv")
write.csv(results26, file = "results26.csv")
write.csv(results27, file = "results27.csv")
write.csv(results28, file = "results28.csv")
write.csv(results29, file = "results29.csv")
write.csv(results30, file = "results30.csv")
write.csv(results31, file = "results31.csv")
write.csv(results32, file = "results32.csv")
write.csv(results33, file = "results33.csv")
write.csv(results34, file = "results34.csv")
write.csv(results35, file = "results35.csv")
write.csv(results36, file = "results36.csv")
write.csv(results37, file = "results37.csv")
write.csv(results38, file = "results38.csv")
write.csv(results39, file = "results39.csv")
write.csv(results40, file = "results40.csv")
write.csv(results41, file = "results41.csv")
write.csv(results42, file = "results42.csv")
write.csv(results43, file = "results43.csv")
write.csv(results44, file = "results44.csv")
write.csv(results45, file = "results45.csv")
write.csv(results46, file = "results46.csv")
write.csv(results47, file = "results47.csv")
write.csv(results48, file = "results48.csv")






#run sim on upper (change function first)
rresultss1<- do.call(rbind, replicate(10000, DID_NB2_mean(1) , simplify=FALSE ))
rresultss2<- do.call(rbind, replicate(10000, DID_NB2_mean(2) , simplify=FALSE ))
rresultss3<- do.call(rbind, replicate(10000, DID_NB2_mean(3) , simplify=FALSE ))
rresultss4<- do.call(rbind, replicate(10000, DID_NB2_mean(4) , simplify=FALSE ))
rresultss5<- do.call(rbind, replicate(10000, DID_NB2_mean(5) , simplify=FALSE ))
rresultss6<- do.call(rbind, replicate(10000, DID_NB2_mean(6) , simplify=FALSE ))
rresultss7<- do.call(rbind, replicate(10000, DID_NB2_mean(7) , simplify=FALSE ))
rresultss8<- do.call(rbind, replicate(10000, DID_NB2_mean(8) , simplify=FALSE ))
rresultss9<- do.call(rbind, replicate(10000, DID_NB2_mean(9) , simplify=FALSE ))
rresultss10<- do.call(rbind, replicate(10000, DID_NB2_mean(10) , simplify=FALSE ))
rresultss11<- do.call(rbind, replicate(10000, DID_NB2_mean(11) , simplify=FALSE ))
rresultss12<- do.call(rbind, replicate(10000, DID_NB2_mean(12) , simplify=FALSE ))
rresultss13<- do.call(rbind, replicate(10000, DID_NB2_mean(13) , simplify=FALSE ))
rresultss14<- do.call(rbind, replicate(10000, DID_NB2_mean(14) , simplify=FALSE ))
rresultss15<- do.call(rbind, replicate(10000, DID_NB2_mean(15) , simplify=FALSE ))
rresultss16<- do.call(rbind, replicate(10000, DID_NB2_mean(16) , simplify=FALSE ))
rresultss17<- do.call(rbind, replicate(10000, DID_NB2_mean(17) , simplify=FALSE ))
rresultss18<- do.call(rbind, replicate(10000, DID_NB2_mean(18) , simplify=FALSE ))
rresultss19<- do.call(rbind, replicate(10000, DID_NB2_mean(19) , simplify=FALSE ))
rresultss20<- do.call(rbind, replicate(10000, DID_NB2_mean(20) , simplify=FALSE ))
rresultss21<- do.call(rbind, replicate(10000, DID_NB2_mean(21) , simplify=FALSE ))
rresultss22<- do.call(rbind, replicate(10000, DID_NB2_mean(22) , simplify=FALSE ))
rresultss23<- do.call(rbind, replicate(10000, DID_NB2_mean(23) , simplify=FALSE ))
rresultss24<- do.call(rbind, replicate(10000, DID_NB2_mean(24) , simplify=FALSE ))
rresultss25<- do.call(rbind, replicate(10000, DID_NB2_mean(25) , simplify=FALSE ))
rresultss26<- do.call(rbind, replicate(10000, DID_NB2_mean(26) , simplify=FALSE ))
rresultss27<- do.call(rbind, replicate(10000, DID_NB2_mean(27) , simplify=FALSE ))
rresultss28<- do.call(rbind, replicate(10000, DID_NB2_mean(28) , simplify=FALSE ))
rresultss29<- do.call(rbind, replicate(10000, DID_NB2_mean(29) , simplify=FALSE ))
rresultss30<- do.call(rbind, replicate(10000, DID_NB2_mean(30) , simplify=FALSE ))
rresultss31<- do.call(rbind, replicate(10000, DID_NB2_mean(31) , simplify=FALSE ))
rresultss32<- do.call(rbind, replicate(10000, DID_NB2_mean(32) , simplify=FALSE ))
rresultss33<- do.call(rbind, replicate(10000, DID_NB2_mean(33) , simplify=FALSE ))
rresultss34<- do.call(rbind, replicate(10000, DID_NB2_mean(34) , simplify=FALSE ))
rresultss35<- do.call(rbind, replicate(10000, DID_NB2_mean(35) , simplify=FALSE ))
rresultss36<- do.call(rbind, replicate(10000, DID_NB2_mean(36) , simplify=FALSE ))
rresultss37<- do.call(rbind, replicate(10000, DID_NB2_mean(37) , simplify=FALSE ))
rresultss38<- do.call(rbind, replicate(10000, DID_NB2_mean(38) , simplify=FALSE ))
rresultss39<- do.call(rbind, replicate(10000, DID_NB2_mean(39) , simplify=FALSE ))
rresultss40<- do.call(rbind, replicate(10000, DID_NB2_mean(40) , simplify=FALSE ))
rresultss41<- do.call(rbind, replicate(10000, DID_NB2_mean(41) , simplify=FALSE ))
rresultss42<- do.call(rbind, replicate(10000, DID_NB2_mean(42) , simplify=FALSE ))
rresultss43<- do.call(rbind, replicate(10000, DID_NB2_mean(43) , simplify=FALSE ))
rresultss44<- do.call(rbind, replicate(10000, DID_NB2_mean(44) , simplify=FALSE ))
rresultss45<- do.call(rbind, replicate(10000, DID_NB2_mean(45) , simplify=FALSE ))
rresultss46<- do.call(rbind, replicate(10000, DID_NB2_mean(46) , simplify=FALSE ))
rresultss47<- do.call(rbind, replicate(10000, DID_NB2_mean(47) , simplify=FALSE ))
rresultss48<- do.call(rbind, replicate(10000, DID_NB2_mean(48) , simplify=FALSE ))




#save output
write.csv(rresultss1, file = "rresultss1.csv")
write.csv(rresultss2, file = "rresultss2.csv")
write.csv(rresultss3, file = "rresultss3.csv")
write.csv(rresultss4, file = "rresultss4.csv")
write.csv(rresultss5, file = "rresultss5.csv")
write.csv(rresultss6, file = "rresultss6.csv")
write.csv(rresultss7, file = "rresultss7.csv")
write.csv(rresultss8, file = "rresultss8.csv")
write.csv(rresultss9, file = "rresultss9.csv")
write.csv(rresultss10, file = "rresultss10.csv")
write.csv(rresultss11, file = "rresultss11.csv")
write.csv(rresultss12, file = "rresultss12.csv")
write.csv(rresultss13, file = "rresultss13.csv")
write.csv(rresultss14, file = "rresultss14.csv")
write.csv(rresultss15, file = "rresultss15.csv")
write.csv(rresultss16, file = "rresultss16.csv")
write.csv(rresultss17, file = "rresultss17.csv")
write.csv(rresultss18, file = "rresultss18.csv")
write.csv(rresultss19, file = "rresultss19.csv")
write.csv(rresultss20, file = "rresultss20.csv")
write.csv(rresultss21, file = "rresultss21.csv")
write.csv(rresultss22, file = "rresultss22.csv")
write.csv(rresultss23, file = "rresultss23.csv")
write.csv(rresultss24, file = "rresultss24.csv")
write.csv(rresultss25, file = "rresultss25.csv")
write.csv(rresultss26, file = "rresultss26.csv")
write.csv(rresultss27, file = "rresultss27.csv")
write.csv(rresultss28, file = "rresultss28.csv")
write.csv(rresultss29, file = "rresultss29.csv")
write.csv(rresultss30, file = "rresultss30.csv")
write.csv(rresultss31, file = "rresultss31.csv")
write.csv(rresultss32, file = "rresultss32.csv")
write.csv(rresultss33, file = "rresultss33.csv")
write.csv(rresultss34, file = "rresultss34.csv")
write.csv(rresultss35, file = "rresultss35.csv")
write.csv(rresultss36, file = "rresultss36.csv")
write.csv(rresultss37, file = "rresultss37.csv")
write.csv(rresultss38, file = "rresultss38.csv")
write.csv(rresultss39, file = "rresultss39.csv")
write.csv(rresultss40, file = "rresultss40.csv")
write.csv(rresultss41, file = "rresultss41.csv")
write.csv(rresultss42, file = "rresultss42.csv")
write.csv(rresultss43, file = "rresultss43.csv")
write.csv(rresultss44, file = "rresultss44.csv")
write.csv(rresultss45, file = "rresultss45.csv")
write.csv(rresultss46, file = "rresultss46.csv")
write.csv(rresultss47, file = "rresultss47.csv")
write.csv(rresultss48, file = "rresultss48.csv")
